plugins {
    id "org.jetbrains.kotlin.jvm" version "1.6.0" apply false
    id "org.jetbrains.kotlinx.kover" version "0.4.4" apply false
    id "org.jetbrains.dokka" version "1.6.0" apply false
    id "io.gitlab.arturbosch.detekt" version "1.19.0" apply false
    id "org.sonarqube" version "3.3"
}

sonarqube {
    properties {
        property "sonar.projectKey", "hwolf_validation"
        property "sonar.organization", "hwolf"
        property "sonar.host.url", "https://sonarcloud.io"
    }
}

subprojects {

    apply plugin: "org.jetbrains.kotlin.jvm"
    apply plugin: "org.jetbrains.kotlinx.kover"
    apply plugin: "io.gitlab.arturbosch.detekt"

    repositories {
        mavenCentral()
    }

    dependencies {
        implementation(platform("org.jetbrains.kotlin:kotlin-bom"))

        testImplementation(platform("org.junit:junit-bom:5.8.2"))
        testImplementation(platform("io.strikt:strikt-bom:0.33.0"))

        testImplementation "org.junit.jupiter:junit-jupiter"
        testImplementation "org.junit.jupiter:junit-jupiter-params"
        testImplementation "dev.minutest:minutest:2.0.0-rc4"
        testImplementation "io.strikt:strikt-core"
        testImplementation "io.mockk:mockk:1.12.1"
    }

    compileKotlin {
        kotlinOptions {
            freeCompilerArgs = ["-Xjsr305=strict"]
            jvmTarget = "17"
        }
    }

    compileTestKotlin {
        kotlinOptions {
            freeCompilerArgs = ["-Xjsr305=strict"]
            jvmTarget = "17"
        }
    }

    test {
        useJUnitPlatform()
        kover {
            enabled = true
        }
    }

    detekt {
        config = files("${rootDir}/config/detekt/detekt.yml")
        reports {
            html.enabled = true
            txt.enabled = false
            xml.enabled = false
        }
    }
}
